@{
    ViewData["Title"] = "Productos";
}
@model ProductoFormulaViewModel

<h2 class="mb-4">Crear Producto con Materiales</h2>

<form asp-action="GuardarProductoConFormula" method="post" class="border p-4 rounded shadow-sm">
    <div class="mb-3">
        <label asp-for="NombreProducto" class="form-label">Nombre del producto</label>
        <input asp-for="NombreProducto" class="form-control" />
        <span asp-validation-for="NombreProducto" class="text-danger"></span>
    </div>

    <h4 class="mt-4">Materiales</h4>
    <div id="materiales">
        <div class="row mb-2 material">
            <div class="col-md-6">
                <select name="Materiales[0].IdFormula" class="form-select">
                    <option value="1">Agua</option>
                    <option value="2">Fragancia</option>
                    <option value="3">Colorante</option>
                </select>
            </div>
            <div class="col-md-4">
                <input name="Materiales[0].Cantidad" class="form-control" placeholder="Cantidad" type="number" step="0.01" min="0" />
            </div>
        </div>
    </div>

    <button type="button" class="btn btn-secondary mt-2" onclick="agregarMaterial()">Agregar Material</button>
    <button type="submit" class="btn btn-primary mt-3">Guardar Producto</button>
</form>

@section Scripts {
    <script>
        let index = 1;
        const opciones = `
            <option value="1">Agua</option>
            <option value="2">Fragancia</option>
            <option value="3">Colorante</option>
        `;

        function agregarMaterial() {
            const container = document.getElementById("materiales");
            const nuevo = document.createElement("div");
            nuevo.classList.add("row", "mb-2", "material");
            nuevo.innerHTML = `
                <div class="col-md-6">
                    <select name="Materiales[${index}].IdFormula" class="form-select">
                        ${opciones}
                    </select>
                </div>
                <div class="col-md-4">
                    <input name="Materiales[${index}].Cantidad" class="form-control" placeholder="Cantidad" type="number" step="0.01" min="0" />
                </div>
            `;
            container.appendChild(nuevo);
            index++;
        }
    </script>
}
